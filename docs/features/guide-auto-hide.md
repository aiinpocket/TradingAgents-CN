# 使用指南自動隐藏功能

## 📖 功能概述

為了提升用戶體驗和優化屏幕空間利用，我們實現了使用指南的智能自動隐藏功能。该功能會根據用戶的操作狀態自動調整使用指南的顯示狀態。

## ✨ 功能特性

### 🎯 智能顯示逻辑

1. **初次訪問**: 默認顯示使用指南，幫助新用戶了解操作流程
2. **開始分析**: 點擊"開始分析"按钮後自動隐藏使用指南，節省屏幕空間
3. **分析完成**: 保持隐藏狀態，让用戶專註於分析結果
4. **用戶控制**: 用戶可以隨時手動控制使用指南的顯示/隐藏

### 🧠 智能記忆

- **偏好記忆**: 系統會記住用戶的顯示偏好設置
- **狀態保持**: 在會話期間保持用戶的選擇
- **優先級**: 用戶手動設置的優先級高於自動逻辑

## 🔧 實現原理

### 狀態管理

```python
# 默認顯示逻辑
default_show_guide = not (
    st.session_state.get('analysis_running', False) or 
    st.session_state.get('analysis_results') is not None
)

# 用戶偏好管理
if 'user_set_guide_preference' not in st.session_state:
    st.session_state.user_set_guide_preference = False
    st.session_state.show_guide_preference = default_show_guide
```

### 自動隐藏觸發

```python
# 開始分析時自動隐藏
if not st.session_state.get('user_set_guide_preference', False):
    st.session_state.show_guide_preference = False
    logger.info("📖 [界面] 開始分析，自動隐藏使用指南")
```

## 📋 使用場景

### 場景1: 新用戶首次訪問
- **狀態**: 無分析記錄
- **行為**: 顯示使用指南
- **目的**: 幫助用戶了解操作流程

### 場景2: 用戶開始分析
- **狀態**: 點擊"開始分析"按钮
- **行為**: 自動隐藏使用指南
- **目的**: 節省屏幕空間，專註分析進度

### 場景3: 分析完成查看結果
- **狀態**: 有分析結果
- **行為**: 保持隐藏狀態
- **目的**: 让用戶專註於分析報告

### 場景4: 用戶手動控制
- **狀態**: 用戶點擊"顯示使用指南"複選框
- **行為**: 尊重用戶選擇，不再自動隐藏
- **目的**: 满足用戶個性化需求

## 🎨 界面布局

### 顯示使用指南時
```
┌─────────────────┬─────────────┐
│                 │             │
│   分析配置区    │  使用指南   │
│                 │             │
│   分析進度区    │  快速開始   │
│                 │             │
│   分析結果区    │  常见問題   │
│                 │             │
└─────────────────┴─────────────┘
     2/3 宽度        1/3 宽度
```

### 隐藏使用指南時
```
┌─────────────────────────────────┐
│                                 │
│         分析配置区              │
│                                 │
│         分析進度区              │
│                                 │
│         分析結果区              │
│                                 │
└─────────────────────────────────┘
           全宽度
```

## 🔍 技術細節

### Session State 變量

- `analysis_running`: 分析是否正在運行
- `analysis_results`: 分析結果數據
- `user_set_guide_preference`: 用戶是否手動設置過偏好
- `show_guide_preference`: 用戶的顯示偏好

### 逻辑優先級

1. **用戶手動設置** (最高優先級)
2. **分析狀態自動逻辑** (中等優先級)
3. **默認顯示逻辑** (最低優先級)

## 📊 用戶體驗優化

### 優化前
- 使用指南始终顯示，占用屏幕空間
- 分析結果顯示区域較小
- 用戶需要手動隐藏指南

### 優化後
- 智能自動隐藏，節省屏幕空間
- 分析結果顯示区域更大
- 保持用戶控制權
- 新用戶仍能看到指南

## 🧪 測試驗證

功能已通過完整的測試驗證：

1. ✅ 初始狀態默認顯示使用指南
2. ✅ 開始分析時自動隐藏使用指南
3. ✅ 有分析結果時保持隐藏狀態
4. ✅ 用戶手動設置後尊重用戶選擇

## 💡 使用建议

### 對於新用戶
- 首次訪問時仔細阅讀使用指南
- 了解基本操作流程後開始分析
- 系統會自動優化界面布局

### 對於熟練用戶
- 可以手動控制使用指南顯示
- 享受更大的分析結果顯示区域
- 需要時隨時重新顯示指南

### 對於開發者
- 功能完全向後兼容
- 不影響現有的界面逻辑
- 可以根據需要調整自動隐藏條件

## 🔮 未來擴展

1. **個性化設置**: 允許用戶設置默認偏好
2. **響應式布局**: 根據屏幕尺寸自動調整
3. **快捷键支持**: 支持键盘快捷键切換
4. **使用統計**: 收集用戶使用习惯數據

---

*该功能旨在提升用戶體驗，在保持功能完整性的同時優化界面布局。*