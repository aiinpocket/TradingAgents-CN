# 招商銀行新聞分析质量問題分析報告

## 問題概述

用戶反馈招商銀行（600036）的新聞分析報告"不像新聞分析的結果"，經過深入分析發現問題根源在於**东方財富新聞數據源质量問題**。

## 問題詳細分析

### 1. 新聞數據源問題

**东方財富API返回的新聞內容偏離主題：**

```
查詢股票：招商銀行（600036）
實际返回的新聞主題：
- 上證180ETF指數基金（530280）
- A500ETF基金（512050）  
- 銀行ETF指數（512730）
- 大湾区發展主題指數
```

**新聞標題示例：**
1. "上證180ETF指數基金（530280）自帶杠铃策略，上證180ETF指數基金近1周涨超2%"
2. "A500ETF基金(512050多股涨停，機構稱補涨機會更值得關註"
3. "銀行ETF指數(512730多只成分股上涨，多家銀行業绩預喜"

### 2. 新聞內容质量分析

**問題特征：**
- ❌ 新聞標題顯示為"無標題"
- ❌ 內容主要關於ETF和指數基金，而非招商銀行公司本身
- ❌ 招商銀行只是作為指數成分股被提及
- ❌ 缺乏招商銀行的具體業務、財務、战略等公司新聞

**實际新聞內容預覽：**
```
數據顯示，截至2025年6月30日，上證180指數(000010)前十大權重股分別為
贵州茅台(600519)、紫金矿業(601899)、中國平安(601318)、恒瑞醫藥(600276)、
招商銀行600036、長江电力(600900)、藥明康德(603259)、兴業銀行(601166)...
```

### 3. 對新聞分析師的影響

**LLM基於低质量新聞數據生成的報告特征：**
- 📊 包含大量指數基金和ETF分析
- 📈 權重股地位分析（而非公司新聞）
- 💹 大宗交易數據（可能來自其他數據源混合）
- 🏦 行業整體分析（銀行業绩預喜等）
- 📋 投資建议和技術分析（超出新聞分析範围）

**結果：** LLM将這些混合信息整合成了一份"综合投資分析報告"，而不是純粹的"新聞分析報告"。

## 根本原因

### 1. 數據源選擇問題
- 东方財富個股新聞API (`stock_news_em`) 返回的是"相關新聞"而非"公司新聞"
- 包含大量ETF、指數基金等衍生產品新聞
- 缺乏對新聞相關性的過濾機制

### 2. 新聞分析師逻辑問題
- 没有對獲取的新聞质量進行驗證
- 缺乏新聞內容相關性檢查
- 當新聞质量不佳時，没有降級處理機制

### 3. 補救機制過度複雜
- DashScope預處理模式可能加剧了問題
- 强制新聞獲取可能獲取到低质量數據
- 缺乏新聞质量評估和過濾

## 解決方案建议

### 1. 短期修複（立即可行）

**A. 新聞质量過濾**
```python
def filter_relevant_news(news_df, stock_code, company_name):
    """過濾与公司直接相關的新聞"""
    relevant_news = []
    for _, row in news_df.iterrows():
        title = row.get('新聞標題', '')
        content = row.get('新聞內容', '')
        
        # 檢查是否直接提及公司
        if (company_name in title or company_name in content or 
            stock_code in title or stock_code in content):
            # 排除ETF、指數基金相關新聞
            if not any(keyword in title.lower() for keyword in ['etf', '指數基金', '基金']):
                relevant_news.append(row)
    
    return pd.DataFrame(relevant_news)
```

**B. 新聞來源多樣化**
- 優先使用Google新聞（中文）
- 东方財富作為备選
- 增加其他新聞源

### 2. 中期優化

**A. 新聞相關性評分**
```python
def calculate_news_relevance(title, content, stock_code, company_name):
    """計算新聞与公司的相關性評分"""
    score = 0
    
    # 直接提及公司名稱或股票代碼
    if company_name in title: score += 50
    if stock_code in title: score += 40
    if company_name in content: score += 30
    if stock_code in content: score += 20
    
    # 减分項：ETF、指數基金等
    if any(keyword in title.lower() for keyword in ['etf', '指數', '基金']):
        score -= 30
    
    return score
```

**B. 新聞分析師提示詞優化**
- 明確要求分析"公司新聞"而非"相關新聞"
- 增加新聞质量檢查指令
- 當新聞质量不佳時，明確說明並降級處理

### 3. 長期改進

**A. 多數據源整合**
- 集成更多高质量新聞源
- 建立新聞质量評估體系
- 實現智能新聞源選擇

**B. 新聞分析專業化**
- 区分"公司新聞分析"和"市場相關分析"
- 建立新聞類型分類體系
- 提供不同類型的分析模板

## 測試驗證

### 當前問題驗證
```bash
# 測試东方財富新聞质量
python -c "
from tradingagents.dataflows.akshare_utils import get_stock_news_em
news_df = get_stock_news_em('600036')
print('新聞標題示例:', [row.get('新聞標題', '無標題') for _, row in news_df.head(3).iterrows()])
"

# 結果：主要是ETF和指數基金新聞，而非招商銀行公司新聞
```

### 修複後驗證方案
1. 實施新聞過濾機制
2. 測試新聞相關性評分
3. 驗證分析報告质量改善

## 总結

招商銀行新聞分析報告质量問題的根本原因是**东方財富新聞數據源返回了大量与公司本身無關的ETF、指數基金新聞**，導致LLM生成了综合投資分析報告而非純粹的新聞分析報告。

**核心問題：** 數據源质量 > 分析逻辑 > 輸出质量

**解決重點：** 
1. 新聞质量過濾（立即修複）
2. 數據源多樣化（中期優化）  
3. 分析專業化（長期改進）

---
**報告生成時間：** 2025-07-28 22:59  
**問題嚴重程度：** 高（影響新聞分析師核心功能）  
**修複優先級：** P1（需要立即處理）