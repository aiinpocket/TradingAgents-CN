#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
 Python 

"""

import os
import sys
from pathlib import Path

#  - 
S2T_CHARS = {
    # 
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    # 
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
    '': '', '': '', '': '', '': '', '': '',
}

def convert_text(text):
    """"""
    result = []
    for char in text:
        result.append(S2T_CHARS.get(char, char))
    return ''.join(result)

def convert_file(file_path):
    """"""
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            content = f.read()

        # 
        if not any('\u4e00' <= c <= '\u9fff' for c in content):
            return False, ""

        # 
        converted = convert_text(content)

        # 
        if converted == content:
            return False, ""

        # 
        with open(file_path, 'w', encoding='utf-8', newline='') as f:
            f.write(converted)

        return True, ""

    except Exception as e:
        return False, f": {str(e)}"

def main():
    project_root = Path(__file__).parent.parent
    print(f" : {project_root}\n")

    # 
    extensions = {'.py', '.md', '.yaml', '.yml', '.json', '.txt', '.sh', '.rst', '.cfg', '.ini', '.bat'}

    # 
    exclude_dirs = {
        '.git', '.venv', 'venv', '__pycache__', '.pytest_cache',
        'node_modules', '.idea', '.vscode', 'dist', 'build',
        'data_backup_', 'data_cache', 'results', 'logs', 'env',
        '.eggs', 'htmlcov', '.coverage', '.tox'
    }

    # 
    total_files = 0
    converted_files = 0
    skipped_files = 0
    error_files = 0

    print(" ...\n")

    # 
    for root, dirs, files in os.walk(project_root):
        # 
        dirs[:] = [d for d in dirs if not any(exc in d for exc in exclude_dirs)]

        for file in files:
            file_path = Path(root) / file

            # 
            if 'inline_converter.py' in str(file_path):
                continue

            if file_path.suffix not in extensions:
                continue

            total_files += 1
            success, message = convert_file(file_path)

            rel_path = file_path.relative_to(project_root)

            if success:
                converted_files += 1
                # 
                with open(file_path, 'r', encoding='utf-8') as f:
                    new_content = f.read()
                char_count = sum(1 for c in new_content if '\u4e00' <= c <= '\u9fff')
                print(f" {rel_path}")
                print(f"    {char_count} ")
            elif "" in message:
                error_files += 1
                print(f" {rel_path}: {message}")
            else:
                skipped_files += 1
                # print(f"  {rel_path}: {message}")  # 

    # 
    print(f"\n{'='*60}")
    print(f" ")
    print(f"   : {total_files}")
    print(f"   : {converted_files}")
    print(f"   : {skipped_files}")
    print(f"   : {error_files}")
    print(f"{'='*60}")

if __name__ == "__main__":
    main()
